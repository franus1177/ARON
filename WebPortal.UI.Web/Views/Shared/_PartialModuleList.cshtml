@using WebPortal.UI.Web.GlobalResource;
@using System.Collections;
@using WebPortal.Business.Entities.Utility;
@{
    var User_LoginInfo = this.Session["User_LoginInfo"];
    Hashtable _User = (Hashtable)User_LoginInfo;
    var CurrentLanguageCode = Convert.ToString(_User["LanguageCode"].ToString());
    var UserModules = Convert.ToString(_User["UserModules"].ToString());
    var CurrentModuleCode = Convert.ToString(_User["CurrentModuleCode"].ToString());
    var ModuleCount = UserModules.Split(',').Length - 1;
}
<style type="text/css">
    .SelectedModule {
        line-height: 25px !important;
        border: 3px solid #191818 !important;
        border-radius: 3px !important;
    }

    .SelectedSmallModule {
        line-height: 0px !important;
        border: 1px solid #191818 !important;
        border-radius: 0px !important;
    }

    .sidebar .sidebar-shortcuts-large > .btn {
        width: 40px !important;
    }
</style>
<div class="sidebar-shortcuts" id="sidebar-shortcuts">
    <div class="sidebar-shortcuts-large pull-left" id="sidebar-shortcuts-large" style="/*width:100%;*/margin-left: 5px;">
        @{
            foreach (var item in UserModules.Split(','))
            {
                switch (item)
                {
                    case ModuleCode.Base:
                        {
                            <button id="btn_@item" data-id="@item" class="btn" type="button" style="line-height: 32px;border:1px solid" title="@Resource.ModuleBS" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-bandcamp"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Safety:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-danger" type="button" style="line-height: 32px;" title="@Resource.ModuleSF" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-fire"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Drill:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-warning" type="button" style="line-height: 32px;" title="@Resource.ModuleDR" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-dribbble"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Training:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-info" type="button" style="line-height: 32px;" title="@Resource.ModuleTR" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-institution"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Incident:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-inverse" type="button" style="line-height: 32px;" title="@Resource.ModuleIN" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-bolt"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.FRAS:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-primary" type="button" style="line-height: 32px;" title="@Resource.ModuleFR" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-exclamation-triangle"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Hira:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-success" type="button" style="line-height: 32px;" title="@Resource.ModuleRA" onclick="OpenHIRA()">
                                <i class="ace-icon fa fa-tachometer"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Work:
                        {
                            <button id="btn_@item" data-id="@item" class="btn label-purple" type="button" style="line-height: 32px; background-color:#808000 !important;" title="@Resource.ModuleWR" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-laptop"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Fleet:
                        {
                            <button id="btn_@item" data-id="@item" class="btn" type="button" style="line-height: 32px; background-color:#018F98 !important;" title="@Resource.ModuleFM" onclick="OpenFleet()">
                                <i class="ace-icon fa fa-truck"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Compliance:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-pink" type="button" style="line-height: 32px;" title="@Resource.ModuleCM" onclick="OpenCompliance(this)">
                                <i class="ace-icon fa fa-check-circle-o"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Audit:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-purple" type="button" style="line-height: 32px;" title="@Resource.FacilityAudit" onclick="OpenAudit(this)">
                                <i class="ace-icon fa fa-clipboard"></i>
                            </button>
                            break;
                        }
                    case ModuleCode.Asset:
                        {
                            <button id="btn_@item" data-id="@item" class="btn btn-primary" type="button" style="line-height: 32px; background-color:#955E60 !important;" title="@Resource.ModuleAM" onclick="ChangeModule(this)">
                                <i class="ace-icon fa fa-cubes"></i>
                            </button>
                            break;
                        }
                }
            }
        }
    </div>
    <div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
        @{
            foreach (var item in UserModules.Split(','))
            {
                switch (item)
                {
                    case ModuleCode.Base:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bandcamp" style="background-color:#955E60 !important;" title="@Resource.Base"></span>break;
                        }
                    case ModuleCode.Safety:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bandcamp btn-danger" style="background-color:#955E60 !important;" title="@Resource.Safety"></span>break;
                        }
                    case ModuleCode.Drill:
                        {<span id="btnSmall_@item" data-id="@item" class="btn btn-dribbble btn-warning" title="@Resource.Drill"></span>break;
                        }
                    case ModuleCode.Training:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-institution btn-info" title="@Resource.Training"></span> break;
                        }
                    case ModuleCode.Incident:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-inverse" title="@Resource.Incident"></span>break;
                        }
                    case ModuleCode.FRAS:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-inverse" title="FRAS"></span>break;
                        }
                    case ModuleCode.Hira:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-inverse" title="Hira"></span>break;
                        }
                    case ModuleCode.Work:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-inverse" style="background-color:#808000 !important;" title="Work"></span>break;
                        }
                    case ModuleCode.Fleet:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-inverse" style="background-color:#018F98 !important;" title="Fleet"></span>break;
                        }
                    case ModuleCode.Compliance:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-pink" title="Compliance"></span>break;
                        }
                    case ModuleCode.Audit:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-purple" title="Audit"></span>break;
                        }
                    case ModuleCode.Asset:
                        {<span id="btnSmall_@item" data-id="@item" class="btn fa fa-bolt btn-primary" title="Asset"></span>break;
                        }
                }
            }
        }
    </div>
</div>
<script type="text/javascript">
    var _CurrentModuleCode = "@CurrentModuleCode";
    var _ModuleCount = "@ModuleCount";

    if (eval(_ModuleCount) == 1) $('#sidebar-shortcuts').remove();//hide();

    function OpenHIRA() {
        window.open("http://rgiahira.e-grc.com");
    }

    function OpenCompliance() {
        window.open("http://rgiahira.e-grc.com/default.aspx?Module=a21bc65");
    }

    function OpenDrill() {
        window.open("https://drill.e-grc.com");
    }

    function OpenFleet() {
        window.location.href = "/Safety/VehicleDashboard/Index/4w$hmyEnvTg=";
    }

    function OpenAudit() {
        window.location.href = "/Safety/LocationDeviationResoultion/list/yaREB0ksvqM=";
    }

    function ChangeModule(id) {

        var _ModuleCode = $(id).attr("data-id");
        var url = window.location.origin;
        var __ScreenID = null;
        switch (_ModuleCode) {
            case "@ModuleCode.Base": { __ScreenID = globalScreenID.DashboardScreenID; break; }
            case "@ModuleCode.Safety": { __ScreenID = globalScreenID.SafetyDashboardScreenID; break; }
            case "@ModuleCode.Drill": { __ScreenID = globalScreenID.DrillDashboardScreenID; break; }
            case "@ModuleCode.Incident": { __ScreenID = globalScreenID.IncidentDashboardScreenID; break; }
            case "@ModuleCode.Training": { __ScreenID = globalScreenID.TrainingDashboardScreenID; break; }
            case "@ModuleCode.FRAS": { __ScreenID = globalScreenID.FRASDashboardScreenID; break; }
            case "@ModuleCode.Work": { __ScreenID = globalScreenID.WorkDashboardScreenID; break; }
            case "@ModuleCode.Fleet": { __ScreenID = globalScreenID.FleetDashboardScreenID; break; }
            case "@ModuleCode.Compliance": { __ScreenID = globalScreenID.ComplianceDashboardScreenID; break; }
            case "@ModuleCode.Audit": { __ScreenID = globalScreenID.AuditDashboardScreenID; break; }
            case "@ModuleCode.Asset": { __ScreenID = globalScreenID.AssetDashboardScreenID; break; }

        }

        if (__ScreenID != null)
            window.open(url + "/AjaxCommonData/RedirectTo/?DefaultModuleCode=" + _ModuleCode + "&ScreenID=" + __ScreenID, "_self");
        else if (__ScreenID == undefined || __ScreenID == null || __ScreenID == "") {
            toastr.error(Resource.DashboardAccessRequired);
        }
    }

    function SetActiveModule(CurrentModule) {
        $("#btn_" + CurrentModule).addClass("SelectedModule");
        $("#btnSmall_" + CurrentModule).addClass("SelectedSmallModule");
    }

</script>
</script>